## 比赛信息

比赛网址：https://adworld.xctf.org.cn/match/contest_challenge?event=147&hash=cf494a33-0f22-4e85-a48d-7a02efeedc90.event

比赛时间：2020年08月29日 09:00~2020年08月31日 09:00

## Writeup

链接：https://pan.baidu.com/s/1ml1ZknT6Zdn3VLrLC_Tk6Q 提取码：hdxw

链接：https://share.weiyun.com/HnuxFzfY 密码：scnal1

外链:https://t1m.lanzous.com/b0af57zbe 密码:hdxw




## 题目信息

### Pwn

#### gif2ascii(4solved,869pt)
> an interesting gif processor
> hint1:CVE-2019-11932 ported on linux
> China:
> 124.70.153.199 4666   
> Overseas:
> 207.246.82.76 4666

附件下载：a72c3563682c49ecaaa575e9f1fa80ba.zip

#### vmpwn(25solved,454pt)
> an easy vm
> China:
> 124.70.153.199 8666 
> Overseas:
> 207.246.82.76 8666

附件下载：64306a28e3fd4410bd8e0869b739a5fd.zip

#### student_manager(13solved,625pt)
> China:
> 124.70.197.50 9010 
> Overseas:
> 207.246.82.76 9010

附件下载：10cba636b5c8413c8f8ba057422a1d12.zip

#### feedback(0solved,1000pt)
> China:
> 124.70.197.50 4743 
> Overseas:
> 207.246.82.76 4743

附件下载：6d50f4e616ea49a99c52971dc3281c43.zip

#### sandbox(6solved,800pt)
> online judge
> China:
> http://124.70.135.106:12564 
> Overseas:
> http://149.28.31.156:12564

#### easy_kernel(2solved,952pt)
> hint1:
> 放出一个带符号的文件供参考
> 附件下载：easy_kernel.zip
> hint2:
> 自定义系统调用源码
> 附件下载：sys_newsyscall.zip
> 
> **URL**
> China:124.70.135.106:12574 
> Overseas: 149.28.31.156:12574

附件下载：easy_kernel1.zip

#### babyqemu(6solved,800pt)
> I have a gift for you, have fun :)  PS:username:root
> 
> **URL**
> China:
> 119.3.156.29 8888 
> Overseas:
> 149.248.16.204 8888

附件下载：babyqemu.zip

#### forest(1solved,1000pt)
> Do you want to challenge Boss?Yeah, you must get out of this forest,
> and I am the king of the forest.
> 
> hint: cve-2018-5333
> 
> **URL**
> China：119.3.156.29 9876 
> Overseas：149.248.16.204 9876

附件下载：forest_attachment.zip

#### card(16solved,571pt)
> China：
> 119.3.154.59:9777 
> Overseas：
> 45.77.72.122:9777

附件下载：609b1ff8aec644778367bc22eb8d4aca.zip
### Crypto

#### da Vinci after rsa(23solved,476pt)
> flag格式：
>  flag{xxxx}

附件下载：达芬奇.zip

#### what_r_the_noise(54solved,273pt)
> 噪音太大，听不见
> 
> Too noisy to hear anything
> 
> China:124.71.145.165:9999 
> Overseas: 45.32.47.185:9999

```bash
>nc 124.71.145.165 9999
1.gift
2.myprint flag
3.exit

:1
there is not much i can tell you, all you need to know is that: sensitivity=80 & epsilon=6.5
all i give you is in gibberish


:2
106.041622,96.367238,101.227115,118.422723,106.622059,120.523708,119.933832,113.050296,115.432539,95.304591,106.876641,110.794822,110.159196,119.07244
7,101.261879,113.762977,117.844434,100.520563,100.635776,95.641918,87.870912,96.074633,107.552165,119.499722,112.905578,94.411239,96.403502,100.933291
,118.378237,99.789506,101.069880,117.023736,101.680675,108.602288,116.857941,105.132783,96.965554,115.761262,93.570437,114.086532,114.146597,107.06974
5,117.406474,101.075012,97.485201,120.067532,127.548477,
:3
```



#### square(25solved,454pt)
> China 124.71.158.89:8888 
> Overseas 104.207.132.137:8888
> 

附件下载：square.zip

#### babycrypto(22solved,487pt)
附件下载：challenge.zip

#### elgaml_rsa(22solved,487pt)
附件下载：elgaml_rsa.zip

#### ezAES(44solved,317pt)
附件下载：ezAes.zip

### Misc

#### v for Vendetta(6solved,800pt)
> v is the hero in my mind 
> hint1:注意每一帧图片的不同之处(Pay attention to the difference in each frame)
> hint2:尝试找出藏在GIF图片内的二维码(Try to find the QR code hidden in the GIF picture)
> 

附件下载：v.zip（114M，微云没有）

#### capture(20solved,512pt)
> 截获到的虚拟世界到现实世界的消息
> 
> message captured from virtual world to real world
> 

附件下载：captured.zip

#### music(4solved,869pt)
> 来听段音乐
> let's enjoy the music
> hint1:注意观察音轨(Pay attention to the audio track)
> hint2:不用audicity和隐写的一些软件来尝试解题 (it is not possible to solve this challenge with audicity or some stego softwares)
> hint3:波形不是波形

附件下载：music.zip

#### trihistory(24solved,465pt)
> triple history
> docker pull impakho/trihistory:latest

#### RIG(10solved,689pt)
> RIG是一个小有名气的黑客，圈内人都叫他exploit kid。RIG最近开发出了一套攻击工具包，利用浏览器漏洞在网络上兴风作浪。作为一个安全工程师的你，需要从捕获到的报文中找到RIG的攻击流量，从攻击流量中找到RIG使用的shellcode，提交shellcode的前13个字节的大写hex数据作为flag,温馨提示,请勿轻易运行哦:)  
> RIG is a small well-known hacker, and everyone in the circle calls him an exploit kid. RIG has recently developed a set of attack toolkits to use browser vulnerabilities to make waves on the Internet. As a security engineer, you need to find the attack traffic of RIG from the captured packets, find the shellcode used by RIG from the attack traffic, and submit the first 13 bytes of uppercase hex data of the shellcode as the flag. Warm reminder, please Don't run it easily :)  
> 


附件下载：RIG.zip

#### crymisc(65solved,238pt)
> 8.25 is Chinese Valentine's Day.Yesterday my brother told me he was refused by a beautiful girl.He was sooooooooooooo sad and bursted into tears.

附件下载：crymisc.zip

#### misc_chunk(7solved,769pt)
> 这是一道披着pwn皮的misc题
> 
> like pwn but misc
> 
> **URL**
> China:
> 121.37.132.75 7777
> 121.37.160.64 8888
> Overseas: 
> 108.160.128.22 8124
> 

附件下载：misc_chunk.zip

#### oldmodem(17solved,555pt)
> old modem (bell 202)
> 

附件下载：oldmodem.zip

#### Minecraft Redstone Music(5solved,833pt)
> 一首简单的红石音乐，但是出了点问题
> An easy redstone music but something wrong
> hint1:注意查看日志(Pay attention to the log)

附件下载：minecraft.rar（432M，只百度网盘有）



#### SignIN(454solved,42pt)
> 内容裹上GACTF{}后提交
> submit with GACTF{}
> 
> 交流群：QQ：282546 TG：https://t.me/GACTF

附件下载：315209b662bb46c6b5080e5794fc0480.zip

#### GACTF FeedBack(114solved,150pt)
> 问卷调查（FeedBack）：https://docs.google.com/forms/d/e/1FAIpQLSeiZiR5nkcP1M8UnJCblI3SanHSHTB2oa0CLrWSSs8DOs3odA/viewform?usp=sf_link
```
GACTF{Thanks_for_your_FeedBack}
```



### Web

#### XWiki(44solved,317pt)
> XCTFer, do you know XWiki?
> 题目每10分钟重启，如遇到无法连接，请稍等片刻10秒左右会全部重启完毕
> This topic restart every 10 minitues. If you can't connect, please wait for a while and the restart will be completed. Do not panic
> China：
> 119.3.111.133 1234
> Overseas：
> 45.77.161.86 1234
> New Overseas nodes:
> 45.32.61.238 1234
> 45.76.216.38 1234
> 45.32.250.242 1234
> 
> hint:拿了shell的师傅们手下留情吧，别捣乱了！

#### babyshop(11solved,666pt)
> babyshop
> 
> China：
> 119.3.111.239 8010
> 
> Overseas：
> 45.63.19.130 8010

git泄露

源码下载：babyshop.zip

#### EZFLASK(50solved,289pt)
> flask&flask
> 
> China：
> 124.70.206.91 10000-10009
> Overseas：
> 149.28.226.175 10000-10009

```python
# -*- coding: utf-8 -*-
from flask import Flask, request
import requests
from waf import *
import time
app = Flask(__name__)

@app.route('/ctfhint')
def ctf():
    hint =xxxx # hints
    trick = xxxx # trick
    return trick

@app.route('/')
def index():
    # app.txt
@app.route('/eval', methods=["POST"])
def my_eval():
    # post eval
@app.route(xxxxxx, methods=["POST"]) # Secret
def admin():
    # admin requests
if __name__ == '__main__':
    app.run(host='0.0.0.0',port=8080)
```



#### sssrfme(11solved,666pt)
> 比EZFLASK更懂ssrf
> 
> Understand more  ssrf than EZFLASK
> 
> sssrfme 提示
> 1. redis存在弱口令
> 2. 全程只能使用http https协议
> 3. 如果前面几步都绕过了还不行，那一定是redis自身的安全机制问题
> 
> 
> sssrfme hints:
> 1. Redis has a weak password
> 2. Only http https protocol can be used throughout
> 3. If the previous steps are not bypassed, it must be redis's own security mechanism.
> 
> China：
> 121.36.199.21 10801-10809
> Overseas：
> 45.77.217.198  10801-10809

```php
<?php
// ini_set("display_errors", "On");
// error_reporting(E_ALL | E_STRICT);


function safe_url($url,$safe) {
    $parsed = parse_url($url);
    $validate_ip = true;
    if($parsed['port']  && !in_array($parsed['port'],array('80','443'))){

        echo "<b>请求错误:非正常端口,因安全问题只允许抓取80,443端口的链接,如有特殊需求请自行修改程序</b>".PHP_EOL;
        
        return false;
    }else{
        preg_match('/^\d+$/', $parsed['host']) && $parsed['host'] = long2ip($parsed['host']);
        $long = ip2long($parsed['host']);
        if($long===false){
            $ip = null;
            if($safe){
                @putenv('RES_OPTIONS=retrans:1 retry:1 timeout:1 attempts:1');
                $ip   = gethostbyname($parsed['host']);
                $long = ip2long($ip);
                $long===false && $ip = null;
                @putenv('RES_OPTIONS');
            }
        }else{
            $ip = $parsed['host'];
        }
        $ip && $validate_ip = filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE);
    }

    if(!in_array($parsed['scheme'],array('http','https')) || !$validate_ip){
        echo "<b>{$url} 请求错误:非正常URL格式,因安全问题只允许抓取 http:// 或 https:// 开头的链接或公有IP地址</b>".PHP_EOL;
        
        return false;
    }else{
        return $url;
    }
}


function curl($url){
    $safe = false;
    if(safe_url($url,$safe)) {
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_HEADER, 0);
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
        $co = curl_exec($ch);
        curl_close($ch);
        echo $co;
    }
}

highlight_file(__FILE__);
curl($_GET['url']);
```



#### say hello to the world(4solved,869pt)
> 这就是一个简单的sayhello程序
> An easy style of sayhello
> maybe port:8002 is helpful
> 
> China ：
> 124.70.166.10 8080
> Overseas：
> 202.182.114.125 8080
> 
> hint:https://github.com/weibocom/motan/wiki/zh_userguide

```
use http://ip/Motan to say hello to Motan
```



#### simpleflask(101solved,166pt)
> 题目每10分钟重启，如遇到无法连接，请稍等片刻10秒左右会全部重启完毕
> This topic restart every 10 minitues. If you can't connect, please wait for a while and the restart will be completed. Do not panic
> 
> China：
> 124.70.153.63 80-89
> Overseas：
> 149.28.80.82 80-89

```python
from flask import Flask, request, render_template_string, redirect, abort
import string

app = Flask(__name__)


white_list = string.ascii_letters + string.digits + "()_-{}.&[]=/"
black_list = ["codecs", "system", "for", "if",
              "end", "os", "eval", "request", "write",
              "mro", "compile", "execfile", "exec",
              "subprocess", "importlib", "platform", "timeit",
              "import", "linecache", "module", "getattribute",
              "pop", "getitem", "decode", "popen",
              "ifconfig", "flag", "config"]


def check(s):
    # print(len(s))
    if len(s) > 131:
        abort(500, "hacker")
        # abort(500, "hacker len")
    for i in s:
        if i not in white_list:
            abort(500, "hacker")
            # abort(500, "hacker white")
    for i in black_list:
        if i in s:
            abort(500, "hacker")
            # abort(500, "hacker black")


@app.route("/", methods=["POST"])
def hello_world():
    try:
        name = request.form["name"]
    except Exception:
        return render_template_string("<h1>request.form[\"name\"]<h1>")

    if name == "":
		return render_template_string("<h1>hello world!<h1>")

	check(name)
	template = '<h1>hello {}!<h1>'.format(name)
	res = render_template_string(template)
    if "flag" in res:
        abort(500, "hacker")
    return res


if __name__ == '__main__':
    app.run(host="0.0.0.0", debug=True)
```



#### carefuleyes(26solved,444pt)
> www.zip
> 
> China：124.71.191.175 80
> Overseas: 202.182.118.236 80
源码下载：www.zip

### Reverse

#### EasyRe(38solved,350pt)
> Layers of protection～
> 

附件下载：6ace662039c147fd91df87b162eb9dd4.zip

#### InfaintRe(3solved,909pt)
> This question is a simple reverse!
> hint1:理清程序逻辑，看看程序是对数据怎么做校验的？
> hint1: clarify the program logic and see how the program checks the data?
> hint2:程序是静态链接的，使用比较知名的library，不要被library的代码迷惑了
> The program is statically linked, use the well-known library, don't be confused by the library code
> hint3:程序使用了一个不是很常见的对称加密算法
> Hint3: the program uses a less common symmetric encryption algorithm

附件下载：9c12b4fbe2734685862c8ad177bc4fbd.zip

#### PicCompress(4solved,869pt)
> hint1:压缩方法是使用数据的重复信息来进行数据压缩
> hint1:The compression method is to compress the data by using the repeated information of the data

附件下载：96d9bcbfb9bd4f0092b9a13e31e23f22.zip

#### Simulator(25solved,454pt)
> Study 《Introduction to Computer System》 carefully,the format of flag is GACTF{}
> 

附件下载：211cc42a209643d893acdcee481131e6.zip

#### WannaFlag(40solved,338pt)
附件下载：00c6d7a83c2d4e37a7f205cba025df12.zip

#### Checkin(100solved,168pt)
> It is recommended to use a virtual machine to run
> 

附件下载：461153d5b4674c3e94410baf895aae5e.zip
